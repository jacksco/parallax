function loadFollowing(){function t(t){$("div.listitempage:last").after(t.response),next_data_url=t.next_data_url,next_data_cache=!1,$.getJSON(next_data_url,function(t){next_data_cache=t})}""==next_data_url?$("div.pagination").show():(is_loading=1,$("div.pagination").hide(),next_data_cache?(t(next_data_cache),is_loading=0):$.getJSON(next_data_url,function(a){t(a),is_loading=0}))}function loadPrevious(){function t(t){$("div.listitempage:first").before(t.response),item_height=$("div.listitempage:first").height(),window.scrollTo(0,$(window).scrollTop()+item_height),prev_data_url=t.prev_data_url,prev_data_cache=!1,$.getJSON(prev_data_url,function(t){prev_data_cache=t}),hide_on_load&&($(hide_on_load).hide(),hide_on_load=!1)}""==prev_data_url?$("div.pagination").show():(is_loading=1,$("div.pagination").hide(),prev_data_cache?(t(prev_data_cache),is_loading=0):$.getJSON(prev_data_url,function(a){t(a),is_loading=0}))}function mostlyVisible(t){var a=$(window).scrollTop(),e=$(window).height(),i=$(t).offset().top,n=$(t).height(),o=i+n;return o-.25*n>a&&a+.5*e>i}function initPaginator(){$(window).scroll(function(){var t=$(window).scrollTop();t>=.9*($(document).height()-$(window).height())&&(console.log("here"),0==is_loading&&loadFollowing()),t<=.9*$("#header").height()&&0==is_loading&&loadPrevious(),Math.abs(t-last_scroll)>.1*$(window).height()&&(last_scroll=t,$(".listitempage").each(function(){return mostlyVisible(this)?(history.replaceState(null,null,$(this).attr("data-url")),$("#pagination").html($(this).attr("data-pagination")),!1):void 0}))}),$(document).ready(function(){if($(window).height()>$("#container").height())if(console.log("test"),""!=next_data_url)loadFollowing();else{var t=document.createElement("div");t.id="filler",t.style.height=$(window).height()-$("#container").height()+"px",$("#container").after(t),hide_on_load="filler"}head_height=$("#header").height(),window.scrollTo(0,head_height)})}function primeCache(){$.getJSON(prev_data_url,function(t){prev_data_cache=t}),$.getJSON(next_data_url,function(t){next_data_cache=t})}var next_data_url,prev_data_url,next_data_cache,prev_data_cache,last_scroll=0,is_loading=0,hide_on_load=!1;